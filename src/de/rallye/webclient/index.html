<html>
<head>
<title>Rallye</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<script type="text/javascript">

function findRoot() {

	var loc = document.location.href;
	var pos = loc.indexOf('/',8);
	return loc.substr(0,pos+1);

}

function get_system_info(callback) {
	$.ajax({
		url: root+"rallye/system/info",
		dataType: "json"
	}).done(callback)
}

function setup_error_handler() {

	$(document).bind("ajaxError",function(event, xhr, ajaxOptions, thrownError) {
		var readable;
		console.log(xhr.status);
		if (xhr.status==0) {
			if(thrownError)
				readable = thrownError;
			else readable = xhr.statusText;
		} else {
			readable = xhr.status+" "+xhr.statusText;
			if (xhr.statusText!=thrownError)
				readable+=" "+thrownError;
		}
		alert(readable);
	});
}

var root = findRoot();

$(function () {


	setup_error_handler();


	get_system_info(function(res) {
		$("#servername").html("<b>"+res.name+"</b><br>"+res.description);
		document.title=res.name;
	});


});

</script>
</head>
<body>
<div id="servername">
</div>
</body>
</html>